import{o,c as l,F as y,r as m,a as d,b as p,t as h,d as f,e as v,f as w}from"./vendor.7c9c3fe7.js";const S=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function a(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerpolicy&&(e.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?e.credentials="include":r.crossorigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(r){if(r.ep)return;r.ep=!0;const e=a(r);fetch(r.href,e)}};S();var B="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEYAAABICAYAAABLJIP0AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATcSURBVHgB7ZyxbhtHEIZn9o4GHDVMkSJAinORWhQgCTSQxGTHkupSJDD1BM4bSOxSWg8QmEIewKwCBgjgU2LEB9GAz70BnYEgSMnOCXncyeyRYiSZinaPFMHb9QcYPEvHk/bXzu7szC8h3BLVF9Ug9UtND2GTJNYIoYwAZVgBBDDgr5XwVSIBTtJ01I3vR4nJMxCWzM7ply1+6kMErMF6ERPRUX/3t47OzUsTZrv/RU2QeMJPDGCdQUhIUvsmgRYWpvKqVi6l8oAf9B0UCA63xyNftOOtcDDv8wsJU3lRC+748qm6hCLCs2c4GtbnrT+5hclE8eSztQ+dm7hGnFzCqPC5M5KvCi/Kf8RDX9QvhpWAHKg1xSJRFJVsTBcwnjFqO0bEJ2AhEmT95c7zUF0bzxjOTw7AUgSK2Q/cSJhp8haArRAE2RjBUBgOoUdgO5y1T140meYsZ+AAvpcG2jPGx3ETHGE89Pa0hfE88QBcwYdNbWEIKABHIK4MGAhj8W50FYKytjCrKjKtCeVcRwIXMAmlAbjDQD+UCJ0RhidBYhBKdAKOgBLeagsjJcXgCEgU6me+5HXBEZBGXW1hovthgkAhWA6vL3HEZU6j7VoSHIPtcO9JvRhX8HZPvzqztibDhfHT7V/vqUvjBE+i3AdLUY2482tjYVRNlPvQR2AZakwXu5O5jgQjTxzyiz3bN4fQxmRMM3IJo/ovIhV7vIQnUHRYFMENt/BKqzb3IVJt32Is6gUXJ1aiRHNatAudrpU4w5LYKuKao77nj7j7GF3jm1maDSRrxKmeUwFsIJLk/nlj7frblsy0U6naLGvlgCCVtXOCunLj0FWq3G5J/XGTY5WL6Bio0uhKrWbE/wSFY4LXfjrqRrdtNas2vg5SKjURxSb/t0ZcH0Vc0YCzwULCZYGE+8wnKXrduNdJ4BbQFman8W2L12rVpavBOoGcT5E86vd+7MASuVGY7cY3NQRPNbsDWG8SPrC0lyXQtcJUaq1y6S4dcMAWylvHI3o8eoftOOwsVIqdK0yl0QpKSE9ZlGJ663j2jADri6w/7wmTiQL0DIrfYFtInEuZbxY+doiiyGa9GhPk4JIw2ZpiUyuWl4LpmIyZhdJ0O7bSW8dN+vrLXic0ec+FGSOs9dZxEd/4B54JM5ktVrsZgukYtcmEIRL2e+smWbs2ON2enfDWlYQf/P7TD2917hU+ueOtG9JwT/deDiV3vHVIWUVAC7XGBOAONd0bBbokjEHdSAA65K0jE2E+MBfBKrrjrUP9sQqTmwuP1G8OCqe8dUBayZ1CELnjrZNC3xEmfHTHW2fiIxQRl/64QRWC7RDEkUGZM9uuuedsv7cO0ch4MKvg7TYentn6GybqL4Oc9o7vmbxnluBJQHu9dYBt0/d45xd/vomTTz/f/JjDqgo2QXjU/7nzPRhy6UgwficO1SIFlqBCaOMfOIQcXBJGtTU9xL3JX+spNpj9BgnWw5yt2vcOkWpLUw8ssjiIEKsxRAu0aL15H/zjTTz45LOtYyzR3cKtObymbPyN+89/6fwFC3CjDWSn0WrxGeNg3bdyNcPVzmraWPuf5+mhBOJz1SOepmvmrYNQJaj9XqcDSySH1awVpARNPn4+4OQnyEqjq6oCqtrRpEwSEuFrH6Eb3ZLV7F+WksYYPlQxdgAAAABJRU5ErkJggg==";var C=(t,n)=>{const a=t.__vccOpts||t;for(const[c,r]of n)a[c]=r;return a};const b={inject:["streamsync"],methods:{registerComponent:function(t,n,a){t.dataset.streamsyncId||(t.dataset.streamsyncId=n,!!a.handlers&&Object.keys(a.handlers).forEach(c=>{t.addEventListener(c,r=>{this.forwardEvent(r)})}))},getContent:function(t,n){if(!n.content)return null;const a=n.content[t];if(a.charAt(0)!="@")return a;const c=a.substring(1);return this.streamsync.state[c]},forwardEvent:function(t){this.streamsync.startTime=performance.now(),this.streamsync.forward(t)}}},E={class:"App"},O=d("div",{class:"header"},[d("img",{src:B,alt:"Streamsync"}),d("h1",null,"Hot drinks demo")],-1),U=d("div",{class:"section"},[d("h2",null,"Gato"),p(" Gato means cat in Spanish ")],-1),j=["value"],R=["src"];function J(t,n,a,c,r,e){return o(),l("div",E,[O,U,(o(!0),l(y,null,m(e.streamsync.components,(s,u)=>(o(),l("div",{key:u,class:"componentShell"},[s.type=="heading"?(o(),l("h1",{key:0,ref_for:!0,ref:i=>{e.registerComponent(i,u,s)}},h(e.getContent("text",s)),513)):f("",!0),s.type=="label"?(o(),l("h3",{key:1,ref_for:!0,ref:i=>{e.registerComponent(i,u,s)}},h(e.getContent("text",s)),513)):f("",!0),s.type=="slider"?(o(),l("input",{key:2,type:"range",value:e.getContent("value",s),ref_for:!0,ref:i=>{e.registerComponent(i,u,s)}},null,8,j)):f("",!0),s.type=="button"?(o(),l("button",{key:3,ref_for:!0,ref:i=>{e.registerComponent(i,u,s)}},h(e.getContent("text",s)),513)):f("",!0),s.type=="text"?(o(),l("p",{key:4,ref_for:!0,ref:i=>{e.registerComponent(i,u,s)}},h(e.getContent("text",s)),513)):f("",!0)]))),128)),d("img",{src:e.streamsync.state.plot},null,8,R)])}var k=C(b,[["render",J]]),A={components:[],state:null,webSocket:null,startTime:null,init:async function(){const n=await(await fetch("/api/init")).json();this.components=n.components,this.state=v(n.state)},startSync:function(){const t=new URL("/api/echo",window.location.href);t.protocol=t.protocol.replace("http","ws"),this.webSocket=new WebSocket(t.href),this.webSocket.onmessage=n=>{const a=JSON.parse(n.data);Object.assign(this.state,a);const c=performance.now();console.log(`Performance ${c-this.startTime} mills`)},this.webSocket.onclose=()=>{this.reconnect()}},reconnect:function(){this.webSocket=null,console.log("Disconnected... Will atempt to reconnect"),this.init().then(()=>{this.startSync()}).catch(()=>{console.log("Reconnect failed... Will try again"),setTimeout(()=>{this.reconnect()},1e3)})},forward:function(t){var a,c;if(!this.webSocket)return;const n={type:t.type,targetId:(a=t.target)==null?void 0:a.dataset.streamsyncId,value:((c=t.target)==null?void 0:c.value)||null};this.webSocket.send(JSON.stringify(n))}};const g=w(k);g.provide("streamsync",A);A.init().then(()=>{A.startSync(),g.mount("#app")});
